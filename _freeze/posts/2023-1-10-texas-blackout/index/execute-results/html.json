{
  "hash": "9c1c5e1a2b1db0c5550279a6a27f5a48",
  "result": {
    "markdown": "---\ntitle: \"Texas Blackout Analysis\"\ndescription: \"An investigation of the impacts of the texas blackout on differing census tracts using satalite and US administrative data.\"\nauthor:\n  - name: Carlo Broderick\n    url: https://carlobroderick.github.io/\n    orcid: 0000-0002-1723-5418\n    affiliation: Master of Environmental Data Science Program @ The Bren School (UCSB) & The National Center for Ecological Analysis & Synthesis\n    affiliation-url: https://ucsb-meds.github.io/ \ndate: 1-10-2023\ncategories: [Quarto, R, MEDS] # self-defined categories\ncitation: \n  url: https://carlobroderick.github.io/posts/1-10-2023-quarto-blogs/ \nimage: texas_light.jpg\ndraft: false # setting this to `true` will prevent your post from appearing on your listing page until you're ready!\nbibliography: references.bib\n---\n\n\n## Overview\n\n\"In February 2021, the state of Texas suffered a major power crisis, which came about as a result of three severe winter storms sweeping across the United States on February 10--11, 13--17, and 15--20.\"[^1] For more background, check out these [engineering](https://www.youtube.com/watch?v=08mwXICY4JM&ab_channel=PracticalEngineering) and [political](https://www.youtube.com/watch?v=Zcrsgdl_hP0&ab_channel=Vox) perspectives.\n\n[^1]: Wikipedia. 2021. \"2021 Texas power crisis.\" Last modified October 2, 2021. <https://en.wikipedia.org/wiki/2021_Texas_power_crisis>.\n\nIn this blog post I will:\\\n- estimate the number of homes in Houston that lost power as a result of the first two storms\\\n- investigate if socioeconomic factors can predict neighborhood power outage\n\nThis analysis will be based on remotely-sensed night lights data, acquired from the [Visible Infrared Imaging Radiometer Suite (VIIRS)](https://en.wikipedia.org/wiki/Visible_Infrared_Imaging_Radiometer_Suite) onboard the Suomi satellite. In particular, we will use the VNP46A1 to detect differences in night lights before and after the storm to identify areas that lost electric power.\n\nTo determine the number of homes that lost power, we will spatially join these data sets with [OpenStreetMap](https://www.openstreetmap.org/#map=4/38.01/-95.84) data on buildings and roads.\n\nTo investigate potential socioeconomic factors that influenced recovery, we will then link your analysis with data from the US Census Bureau.\n\n### Data\n\n#### Night lights\n\nWe will use NASA's Worldview to explore the data around the day of the storm. There are several days with too much cloud cover to be useful; however, 2021-02-07 and 2021-02-16 provide two clear, contrasting images to visualize the extent of the power outage in Texas.\n\nVIIRS data is distributed through NASA's [Level-1 and Atmospheric Archive & Distribution System Distributed Active Archive Center (LAADS DAAC)](https://ladsweb.modaps.eosdis.nasa.gov/). Many NASA Earth data products are distributed in 10x10 degree tiles in sinusoidal equal-area projection. Tiles are identified by their horizontal and vertical position in the grid. Houston lies on the border of tiles h08v05 and h08v06. We therefore need to download two tiles per date and join together for a full view of the city.\\\n\n-   `VNP46A1.A2021038.h08v05.001.2021039064328.h5.tif`: tile h08v05, collected on 2021-02-07\\\n-   `VNP46A1.A2021038.h08v06.001.2021039064329.h5.tif`: tile h08v06, collected on 2021-02-07\\\n-   `VNP46A1.A2021047.h08v05.001.2021048091106.h5.tif`: tile h08v05, collected on 2021-02-16\\\n-   `VNP46A1.A2021047.h08v06.001.2021048091105.h5.tif`: tile h08v06, collected on 2021-02-16\n\n#### Roads\n\nTypically highways account for a large portion of the night lights observable from space (see Google's [Earth at Night](https://earth.google.com/web/@27.44405464,-84.7693044,206.63660162a,8916361.52264659d,35y,0h,0t,0r/data=CiQSIhIgMGY3ZTJkYzdlOGExMTFlNjk5MGQ2ZjgxOGQ2OWE2ZTc)). To minimize falsely identifying areas with reduced traffic as areas without power, we will ignore areas near highways.\n\n[OpenStreetMap (OSM)](https://planet.openstreetmap.org/) is a collaborative project which creates publicly available geographic data of the world. Ingesting this data into a database where it can be subsetted and processed is a large undertaking. Fortunately, third party companies redistribute OSM data. We will use [Geofabrik's download sites](https://download.geofabrik.de/) to retrieve a shapefile of all highways in Texas and prepared a Geopackage (`.gpkg` file) containing just the subset of roads that intersect the Houston metropolitan area. \n\n-   `gis_osm_roads_free_1.gpkg`\n\n#### Houses\n\nWe can also obtain building data from OpenStreetMap. We again downloaded from Geofabrick and prepared a GeoPackage containing only houses in the Houston metropolitan area.\\\n\n-   `gis_osm_buildings_a_free_1.gpkg`\n\n#### Socioeconomic\n\nWe cannot readily get socioeconomic information for every home, so instead we obtained data from the [U.S. Census Bureau's American Community Survey](https://www.census.gov/programs-surveys/acs) for census tracts in 2019. The *folder* `ACS_2019_5YR_TRACT_48.gdb` is an ArcGIS [\"file geodatabase\"](https://desktop.arcgis.com/en/arcmap/latest/manage-data/administer-file-gdbs/file-geodatabases.htm), a multi-file proprietary format that's roughly analogous to a GeoPackage file.\\\n\nWe can use `st_layers()` to explore the contents of the geodatabase. Each layer contains a subset of the fields documents in the [ACS metadata](https://www2.census.gov/geo/docs/maps-data/data/tiger/prejoined/ACSMetadata2011.txt).\\\n\nThe geodatabase contains a layer holding the geometry information, separate from the layers holding the ACS attributes. We will combine the geometry with the attributes to get a feature layer that `sf` can use.\n\n#### Packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(terra)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nterra 1.6.17\n```\n:::\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:terra':\n\n    intersect, union\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(spData)\nlibrary(spDataLarge)\nlibrary(tmap)\nlibrary(geodata)\nlibrary(sf)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLinking to GEOS 3.10.2, GDAL 3.4.2, PROJ 8.2.1; sf_use_s2() is TRUE\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages\n───────────────────────────────────────\ntidyverse 1.3.2 ──\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ ggplot2 3.3.6     ✔ purrr   0.3.4\n✔ tibble  3.1.8     ✔ stringr 1.4.0\n✔ tidyr   1.2.0     ✔ forcats 0.5.1\n✔ readr   2.1.2     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ tidyr::extract() masks terra::extract()\n✖ dplyr::filter()  masks stats::filter()\n✖ dplyr::lag()     masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(rmapshaper)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRegistered S3 method overwritten by 'geojsonlint':\n  method         from \n  print.location dplyr\n```\n:::\n\n```{.r .cell-code}\nlibrary(smoothr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'smoothr'\n\nThe following object is masked from 'package:terra':\n\n    densify\n\nThe following object is masked from 'package:stats':\n\n    smooth\n```\n:::\n\n```{.r .cell-code}\nlibrary(stars)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: abind\n```\n:::\n\n```{.r .cell-code}\nlibrary(here)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nhere() starts at /Users/User/Library/CloudStorage/GoogleDrive-carlwilliambroderick@gmail.com/My Drive/Website/carlobroderick.github.io\n```\n:::\n:::\n\n\n#### Find locations of blackouts\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# read in the two night lights tifs for each time period, before and after the winter storm\n\nraster_2021_02_07_a <- \n  read_stars(here(\"data\", \n                  \"VNP46A1\", \n                  \"VNP46A1.A2021038.h08v05.001.2021039064328.tif\"))\n\nraster_2021_02_07_b <- \n  read_stars(here(\"data\", \n                  \"VNP46A1\", \n                  \"VNP46A1.A2021038.h08v06.001.2021039064329.tif\"))\n\nraster_2021_02_16_a <- \n  read_stars(here(\"data\", \n                  \"VNP46A1\",\n                  \"VNP46A1.A2021047.h08v05.001.2021048091106.tif\"))\n\nraster_2021_02_16_b <- \n  read_stars(here(\"data\", \n                  \"VNP46A1\", \n                  \"VNP46A1.A2021047.h08v06.001.2021048091105.tif\"))\n\n\n# combine tiles into a single stars object for each date\nmosaic_07 <- st_mosaic(raster_2021_02_07_a, raster_2021_02_07_b)\n\nmosaic_16 <- st_mosaic(raster_2021_02_16_a, raster_2021_02_16_b)\n\n# find the change in night lights\nlight_dif <- mosaic_07 - mosaic_16\n\n# check out the images created thus far\nplot_1 <- plot(mosaic_07)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\ndownsample set to 6\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot_2 <- plot(mosaic_16)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\ndownsample set to 6\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n```{.r .cell-code}\nplot_3 <- plot(light_dif)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\ndownsample set to 6\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# reclassify the difference raster, assuming that any location that experienced a drop of more than 200 nW cm-2sr-1 experienced a blackout\nlight_dif[light_dif <= 200] = NA\nlight_dif[light_dif > 200] = 1\n\n# vectorize the blackout mask\nsf_lights <- st_as_sf(light_dif)\n\n# fix any invalid geometries, this is required because the st_as_sf function sometimes does not close polygons, this st_make_valid does that for us\nsf_lights <- st_make_valid(sf_lights)\n\n# define the Houston metropolitan area\nh_poly = list(rbind(c(-96.5, 29), \n                    c(-96.5, 30.5), \n                    c(-94.5, 30.5), \n                    c(-94.5, 29), \n                    c(-96.5, 29)))\n\nhouston_polygon <- st_polygon(h_poly)\n\n# convert the polygon into a simple feature collection\nhouston_area <- st_sfc(houston_polygon, crs = \"EPSG:4326\")\n\n# crop (spatially subset) the blackout mask to our region of interest\nhouston_lights_old_crs <- sf_lights[houston_area, ]\n\n# re-project the cropped blackout dataset to EPSG:3083\nhouston_lights <- st_transform(houston_lights_old_crs , crs = \"EPSG:3083\")\n```\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}