{
  "hash": "6186f59bbecce1b00a867dd23c035a32",
  "result": {
    "markdown": "---\ntitle: \"Searching for Climate Change in Macro-Economic Data\"\ndescription: \"An attmpt to find climate changes impact on national level economic statistics.\"\nauthor:\n  - name: Carlo Broderick\n    url: https://carlobroderick.github.io/\n    orcid: 0000-0002-1723-5418\n    affiliation: Master of Environmental Data Science Program @ The Bren School (UCSB) & The National Center for Ecological Analysis & Synthesis\n    affiliation-url: https://ucsb-meds.github.io/ \ndate: 12-1-2022\ncategories: [Quarto, R, MEDS] # self-defined categories\ncitation: \n  url: https://carlobroderick.github.io/posts/2022-31-24-quarto-blogs/ \nimage: example.jpg\ndraft: false # setting this to `true` will prevent your post from appearing on your listing page until you're ready!\nbibliography: references.bib\n---\n\n\n# Searching for Climate Change in Macro-Economic Data\n\n## Introduction\n\nClimate denialism is slowly fading within the US. On August 15, 2022, The World Economic Forum noted that the current US congress had 7% fewer \"climate deniers\" than the previous session, which in turn, had 23% less climate deniers than the preceeding session. [@climate]\n\nWhile climate denialism may be on the wane it is still a considerable force within American politics.[@brigham] The denialists within the US maintain their beliefs in the face of mounting evidence.[@scientif] So I have taken it upon myself to add to this mounting evidence and attempt show a link between temperature and national level economic indicators.\n\nNote: I will be focusing on climate's impact not on the cause of climate change itself. The correlation between mean temperatures and CO₂ readings from Mt. Mauna Loa in Hawaii are already well known and by themselves do not point to causation. Any more rigorous analysis is beyond my current data science skills, and so, I will leave the anthropocentric attribution to the IPCC.\n\n## Aim\n\nI intend to run a number of regressions to see if I can explain any variability in national macroeconomic indicators with the variability in national average temperature. I.E. Can I see climate change's impact on country level statistics?\n\n## Outline\n\n#### Countries\n\nAll data used in this blog post was provided by the Food and Agriculture Organization of the United Nations.[@faostat] I will limit my analysis to the group of 49 countries designated as the least developed (LDC) by the United Nations.[@leastde] These countries were chosen for this blog post because, according to the UN Development Project, the economic growth of LDCs is highly dependent on climate-sensitive sectors.[@respondi] This high sensitivity will hopefully lead to a low p-value when regressing temperature on national level statistics.\n\n#### Climate Change Metric\n\nThe temperature data I will use to predict national indicators will be *Degrees C* **°** *above or below the* *1951--1980 national mean.*\n\n#### Macro-Economic Indicator\n\nThe national level statistic I will try to predict in this blog post will be: *Annual growth in per capita Gross Domestic Product* denoted in *2015 USD.* While I did attempt to use other metrics in my analysis, this metric seemed the most straightforward to blog about.\n\n## Hypothesis Testing\n\n#### Models\n\nIn my analysis I used the following models:\n\n\n$$\nIndictor(temp) = \\beta_{1}(temp)_{t}\n$$\n\n$$\nIndictor(temp) = \\beta_{1}(temp)_{t} + \\beta_{2}(temp)_{t-1} + \\beta_{3}(temp)_{t-2}\n$$\n\n$$\nIndictor(temp) = \\beta_{1}(year) + \\beta_{2}(temp)_{t} + \\beta_{3}(temp)_{t-1} + \\beta_{4}(temp)_{t-2}\n$$\n\n\nThe first model is a standard linear regression with a single coefficient.\n\nThe second model is a linear regression with two lagged temperature variables that represent the temperature one year and two years before. The thinking here is that temperature may have an effect on our indicator (GDP) in later years.\n\nThe third model is the same as the second except with an additional variable of year. I see in the temperature variable that it has an upward trend, likely due to climate change induced global warming. I worry that if the economic indicator also had a trend then a correlation could be spurious, so in the case that I found any strong high correlation in the first two models I would try and see if adding the time variable lowered the impact of the temperature predictor on the indicator in question.\n\n#### Null and Alternative Hypothesis\n\nMy null hypothesis is that temperature has no effect on GDP and my alternative hypothesis is that temperature has an effect on GDP.\n\n\n$$\nH_{0}: 0 = \\beta_{1} + \\beta_{2} + \\beta_{3}\n$$\n\n$$\nH_{1}: 0 \\neq \\beta_{1} + \\beta_{2} + \\beta_{3}\n$$\n\n\n#### Alpha and Significance\n\nI will set my significance level to 0.01 which indicates a 1% risk of concluding that temperature is predictive when it is not. Even if I achieve a p-value below 0.01 I will have to do some additional validation because I will be regressing multiple models on 49 countries against a number of national level statistics I will be running more than 1,000 regressions. The chances that one of these will find a relationship is relatively high because of the sheer number of attempts.\n\n## Getting Started\n\nThe complete list of libraries, packages, and datasets used in this post can be found here:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# packages\nlibrary(tidyverse)\nlibrary(lubridate)\nlibrary(janitor)\nlibrary(tmap)\nlibrary(readr)\nlibrary(here)\nlibrary(tsibble)\nlibrary(stats)\nlibrary(slider)\nlibrary(patchwork)\nlibrary(knitr)\n\n# Data\ndata(\"World\")\n```\n:::\n\n\nLet's read in and clean the data. This data can be downloaded from the FAOSTAT [website](https://www.fao.org/faostat/en/). While this analysis can be performed on multiple different national level statistics, I chose to use *National GDP* in this blog post for simplicity. To export the CSVs found in this blog post use the [Macro Indicators](https://www.fao.org/faostat/en/#data/MK) data portal for the indicators and the [Temperature Change](https://www.fao.org/faostat/en/#data/ET) data portal for the temperature variable.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# read in the data\ntemp_raw <- read_csv(here(\"posts\", \n                          \"2022-12-05-economic_climate_regression\",\n                          \"FAOSTAT_temp.csv\"))\n\nindi_raw <- read_csv(here(\"posts\", \n                          \"2022-12-05-economic_climate_regression\",\n                          \"FAOSTAT_indicators.csv\"))\n\n# clean column names, remove unneeded columns, rename columns\ntemp_df <- temp_raw |>\n  clean_names() |>\n  select(area, year, value) |>\n  rename(country = area, temp = value)\n\n# clean column names, remove unneeded columns, rename columns\nindi_df <- indi_raw |>\n  clean_names() |>\n  select(area, year, item, value) |>\n  rename(country = area, indicator = value)\n\n# create a single dataframe and lag variables to use for analysis\nanalysis_df <- left_join(indi_df, temp_df, \n                         by = c(\"country\", \"year\")) |>\n  group_by(country) |>\n  mutate(lag_1 = lag(temp, n = 1),\n         lag_2 = lag(temp, n = 2)) |>\n  ungroup()\n```\n:::\n\n\n## Exploring the Data\n\nLet's look at our data a little closer to make sure there are no surprises.\n\n#### Map of Least Developed Countries (LDC)\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# filter World data to only LDCs\nLDC_map <- left_join(World, analysis_df, \n                     by = c(\"name\" = \"country\")) |>\n  filter(!is.na(indicator))\n\n# create a map\ntm_shape(World) +\n  tm_polygons() +\n  tm_shape(LDC_map) +\n  tm_fill(col = \"red\") +\n  tm_layout(main.title = \"Least Developed Countries\",\n            main.title.position = \"center\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n#### Create a time series of temperature and indicator data\n\nWrangle the data\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# create an average temperature and indicator column\nave_stats <- analysis_df |>\n  group_by(year) |>\n  summarize(indicator = mean(indicator), \n            temp = mean(temp, na.rm = TRUE)) |>\n  mutate(country = \"Average\") |>\n  relocate(country)\n\n# filter to just three countries out of 49\ncountry_stats <- analysis_df |>\n  filter(country %in% c(\"Afghanistan\", \"Bangladesh\", \"Zambia\")) |>\n  select(-lag_1, -lag_2, -item)\n\n# combine data into single dataframe for graphing\nplot_df <- rbind(ave_stats, country_stats)\n\n# change the levels for the legend order\nplot_df$country <- as.factor(plot_df$country)\nplot_df$country <- relevel(plot_df$country, \"Average\")\nlevels(plot_df$country)\n```\n:::\n\n\nGraph of indicator (GDP)\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# create a plot of GDP indicator over time\ngdp_series <- ggplot(data = plot_df) +\n  geom_hline(yintercept = 0, color = c(\"grey\")) +\n  geom_line(aes(x = year, y = indicator, color = country)) +\n  labs(y=\"Annual Per Capita GDP Growth in 2015 Dollars\", \n       x=\"Year\", \n       title=\"Annual GDP Growth\", \n       caption = \"Source: FAOSTAT\") +\n  scale_colour_manual(name  = \"Country\", \n                      values = c(\"Average\" = \"#04332c\",\n                                \"Afghanistan\" = \"#ff4c24\",\n                                \"Bangladesh\" = \"#67b62c\",\n                                \"Zambia\" = \"#0184cf\")) +\n  theme(plot.title = element_text(hjust = 0.5))\n\ngdp_series\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nGraph of Temperature\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\n# create a plot of temperature over time\ntemp_series <- ggplot(data = plot_df) +\n  geom_hline(yintercept = 0, color = c(\"grey\")) +\n  geom_line(aes(x = year, y = temp, color = country)) +\n  labs(y=\"Degrees Celsius Above Average\", \n       x=\"Year\", \n       title=\"Degrees above Average Time Series\", \n       caption = \"Source: FAOSTAT\") +\n  scale_colour_manual(name  = \"Country\", \n                      values = c(\"Average\" = \"#04332c\",\n                                \"Afghanistan\" = \"#ff4c24\",\n                                \"Bangladesh\" = \"#67b62c\",\n                                \"Zambia\" = \"#0184cf\")) +\n  theme(plot.title = element_text(hjust = 0.5))\n\ntemp_series\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n#### Moving average of temperature\n\nDuring this analysis I worried that both the dependent and independent variables might have a temporal trend. I attempted to extract that trend out of my temperature coefficients by including a year variable in one of the models I used; however, the addition of year as a predictive variable did not have a strong effect on my model's p-values or the temperature coefficients so it is left out of this blog.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"true\"}\nmoving_average_df <- ave_stats |>\n  mutate(m_average_temp = slide_dbl(temp, \n                                    mean,\n                                    .before = 2,\n                                    .after = 2,\n                                    .complete = TRUE),\n         m_average_indi = slide_dbl(indicator, \n                                    mean,\n                                    .before = 2,\n                                    .after = 2,\n                                    .complete = TRUE)) |>\n  filter(year > 1972) |>\n  filter(year < 2019)\n                               \n\nave_temp <- ggplot(data = moving_average_df) +\n  geom_hline(yintercept = 0, color = c(\"grey\")) +\n  geom_line(aes(x = year, y = m_average_temp)) +\n  labs(y=\"Degrees Celsius Above Average \", \n       x=\"Year\", \n       title=\"Celsius Above Ave. Time Series \n       Moving Average m = 5\", \n       caption = \"Source: FAOSTAT\") +\n  scale_colour_discrete(name  = \"Country\") +\n  theme(plot.title = element_text(hjust = 0.5))\n\nave_gdp <- ggplot(data = moving_average_df) +\n  geom_hline(yintercept = 0, color = c(\"grey\")) +\n  geom_line(aes(x = year, y = m_average_indi)) +\n  labs(y=\"Annual Per Capita GDP Growth in 2015 Dollars\",\n       x=\"Year\", \n       title=\"Annual GDP Growth \n       Moving Average m = 5\", \n       caption = \"Source: FAOSTAT\") +\n  scale_colour_discrete(name  = \"Country\") +\n  theme(plot.title = element_text(hjust = 0.5))\n\nave_gdp  + ave_temp\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n## Performing Regressions\n\nThe code below uses a for loop, this operation can also be done using tidyverse functions which I would actually strongly recommend. The below for loop allows you to put in a dataframe with multiple types of indicators (e.g. agricultural yield growth) which is handy if you're are running this regression on lots of indicators; however, for this blog post I'll just be using our GDP indicator for demonstration.\n\n\n::: {.cell .column-page}\n\n```{.r .cell-code  code-fold=\"true\"}\n# create country list for loop below \ncountry_list <- unique(analysis_df$country)\n\n# when appending rows to the df that is initiated below it's nice to clear the df so that you can run the loop again\n#remove(result_df)\n\n# initialize a df that will be filled by the for loop\nresult_df <- data.frame(country = character(),\n                        temp_d = numeric(),\n                        temp_d_p = numeric(),\n                        temp_lag_1 = numeric(),\n                        temp_lag_1_p = numeric(),\n                        temp_lag_2 = numeric(),\n                        temp_lag_2_p = numeric(),\n                        r2 = numeric(),\n                        n = numeric())\n\n# here is the big for loop that will output a dataframe of the results of all the regressions you run on one or multiple indicators against our temperature variable.\nfor (coi in 1:(length(unique(country_list)))) {\n  \n  lm_data_country <- analysis_df |>\n    filter(country == country_list[coi])\n  \n  # this part of the loop allows for multiple \"item\" which is the title for national level macro economic statists that are exported from FAOSTAT. For our example it just loops once.\n  \n  for (measure in 1:(length(unique(lm_data_country$item)))) {\n    \n    item_list <- unique(lm_data_country$item)\n    \n    lm_data_item <- lm_data_country |>\n      filter(item == item_list[measure])\n    \n    if(sum(is.na(lm_data_item$temp > 10))) next\n    \n    lm_output <- lm(indicator ~ temp +\n                      lag_1 +\n                      lag_2,\n                    data = lm_data_item, \n                    na.action = na.exclude)\n    \n    row <- c(country_list[coi],\n             lm_output$coefficients[[2]],\n             summary(lm_output)[[\"coefficients\"]][\"temp\", \"Pr(>|t|)\"],\n             lm_output$coefficients[[3]],\n             summary(lm_output)[[\"coefficients\"]][\"lag_1\", \"Pr(>|t|)\"],\n             lm_output$coefficients[[4]],\n             summary(lm_output)[[\"coefficients\"]][\"lag_2\", \"Pr(>|t|)\"],\n             summary(lm_output)[9], # adjusted r2\n             count(lm_data_item)) \n     \n    result_df[nrow(result_df) + 1, ] <- row\n  }\n}\n\nround_df <- function(x, digits) {\n    numeric_columns <- sapply(x, mode) == 'numeric'\n    x[numeric_columns] <-  round(x[numeric_columns], digits)\n    x\n}\n\nordered_results <- result_df |>\n  arrange(temp_d_p) |>\n  round_df(3) |>\n  rename(Country = country, \n         Temperature = temp_d, \n         \"Temp p-value\" = temp_d_p,\n         \"1 Yr Lag\" = \"temp_lag_1\",\n         \"1 Yr p-value\" = temp_lag_1_p,\n         \"2 Yr Lag\" = \"temp_lag_2\",\n         \"2 Yr p-value\" = temp_lag_2_p,\n         \"R-Squared\" = r2,\n         Count = n)\n\nkable(ordered_results[1:6, ])\n```\n\n::: {.cell-output-display}\n|Country                          | Temperature| Temp p-value| 1 Yr Lag| 1 Yr p-value| 2 Yr Lag| 2 Yr p-value| R-Squared| Count|\n|:--------------------------------|-----------:|------------:|--------:|------------:|--------:|------------:|---------:|-----:|\n|Guinea-Bissau                    |      -6.517|        0.011|    4.908|        0.086|    0.767|        0.758|     0.083|    50|\n|Gambia                           |      -3.945|        0.029|    0.101|        0.960|    4.017|        0.025|     0.105|    50|\n|Nepal                            |       2.088|        0.081|   -0.530|        0.699|    2.385|        0.046|     0.171|    50|\n|Uganda                           |       4.456|        0.081|   -0.509|        0.860|    1.179|        0.639|     0.061|    50|\n|Democratic Republic of the Congo |       3.236|        0.158|    4.458|        0.110|   -1.992|        0.404|     0.254|    50|\n|Mozambique                       |      -2.917|        0.181|    6.719|        0.004|   -1.191|        0.585|     0.119|    50|\n:::\n:::\n\n\n## Results\n\nFor all indicators, countries, and groups of countries tested (hundreds of lms):\n\n-   I could not find a p-value that was below .011\n\n-   Few adjusted r squares were above .4\n\n-   no low p-valued overlapped with high adjusted R squared.\\\n\nI fail to reject the null hypothesis with a significance level (alpha = 0.01) and a p-value of 0.011.\n\n## Conclusion\n\nI am unable to show that national average temperature can predict any variability in national GDP. I did this exercise with other national metrics and with the other models shown above but this p-value was the lowest value I could find. Even if this p-value fell below my stated alpha, I would be pretty insecure about pointing to this as a smoking gun for climate change's impact on economies. Out the thousand plus regressions that I ran, only one country's data came close to correlating. If you go searching for correlation in this manner you have to make sure that your p-value reflects the number of regressions that you are running, otherwise, you're going to stumble upon some false positives.\n\nSome thoughts about the results:\n\n-   The metric of USD 2015 Dollars inflates and deflates based on strength of a country's currency during each year so that already explains some variability that is not in the model\n\n-   Small sample size per country (\\~50 years)\n\n-   GDP may not be noticeably impacted by climate change at this temporal and spatial scale.\n\n-   The relationship between GDP & Climate Change may be masked by other factors that have a greater impact on GDP, e.g. the invasion and occupation of the country of interest as we can see in the plot above where Afghanistan's GDP growth spikes in the early 2000s.\n\n## Next Steps\n\nTo improve this analysis:\n\n-   Increase spatial and temporal resolution. \n\n-   Restrict temporal resolution to high impact seasons (growing season for agricultural indicators).\n\n-   Investigate indicators that would have a direct relationship to heat, e.g. specific agricultural good statistics or construction.\n\n-   Use other climate change metrics instead of temperature like precipitation or drought indices.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}